function setAirData(t){function a(t){for(var a=0,e=t.length-1;e>=0;e--)a+=Number(t[e]);return Math.floor(10*a)/10}function e(t){for(var a=t,e=a.length-1;""==a[e]&&e>0;)--e;return a[e]}function i(t){return t.length==m}var n='<div class="tabs"><h2>整点天气实况</h2><p id="currHour"></p><p class="second"><b id="detailHour"></b></p><ul><li class="aqi_on on" data-role="air">空气质量</li><li class="p2" data-role="tem">温度</li><li class="sd" data-role="humidity">相对湿度</li><li class="js" data-role="rain">降水量</li><li class="fl" data-role="wind">风力风向</li></ul></div><div class="split"></div><div class="chart"><div id="hourHolder"><div class="xLabel"></div><div class="yLabel"></div><div class="result"></div><div class="showData"></div></div><em>(h)</em><b id="wd"></b> <b id="tem">℃</b> <b id="pm10">(μg/m³)</b> <b id="sd">(%)</b> <b id="js">(mm)</b> <b id="fl">(级)</b><p class="air detail">空气质量指数：简称AQI，是定量描述空气质量状况的无量纲指数。（数据由环保部提供）</p><p class="humidity">相对湿度：空气中实际水汽压与当时气温下的饱和水汽压之比，以百分比（%）表示。</p><p class="pm10 tem">温度：表示大气冷热程度的物理量，气象上给出的温度是指离地面1.5米高度上百叶箱中的空气温度。</p><p class="rain">降水量：某一时段内的未经蒸发、渗透、流失的降水，在水平面上积累的深度，以毫米（mm）为单位。 </p><p class="wind">风力风向：空气的水平运动，风力是风吹到物体上所表示出力量的大小，风向指风的来向。</p><div class="aqiColorExp clearfix"><span class="span1">优</span> <span class="span2">良</span> <span class="span3">轻度</span> <span class="span4">中度</span> <span class="span5">重度</span> <span class="span6">严重</span></div>',s=$("#weatherChart").html(n);Raphael.fn.drawGrid=function(t,a,e,i,n,s){s=s||"#000";for(var r=["M",Math.round(t)+.5,Math.round(a)+.5,"L",Math.round(t+e)+.5,Math.round(a)+.5],l=i/n,o=1;n>=o;o++)r=r.concat(["M",Math.round(t)+.5,Math.round(a+o*l)+.5,"H",Math.round(t+e)+.5]);return this.path(r.join(",")).attr({stroke:s,fill:"#fff"})},Raphael.fn.polygon=function(t,a,e){var i=["M",t,a,"L",t-e*Math.sin(15),a+Math.sin(15)*e*Math.sqrt(3),t,a-e*Math.sin(15)*2,t+e*Math.sin(15),a+Math.sin(15)*e*Math.sqrt(3),"z"];return this.path(i.join(","))};var r=6,l=null,o=function(t,a){return""==t||"null"==t||a&&0==t},d={length:0,date:[],air:[],tem:[],humidity:[],rain:[],rainSum:0,windLevel:[],windAngle:[],windDirection:[],flagData:{air:{max:0,min:0},tem:{max:0,min:0},humidity:{max:0,min:0},rain:{max:0,min:0},wind:{max:0,min:0}},min:{air:0,tem:0,humidity:0,rain:0,wind:0},max:{air:0,tem:0,humidity:0,rain:0,wind:12},step:{air:0,tem:1,humidity:1,rain:1,wind:2},invalid:{air:[],tem:[],humidity:[],rain:[],wind:[]},init:function(t){function a(t){for(var a=-99,e=0;e<t.length;e++)t[e]&&Number(t[e])>a&&(a=t[e]);return a}var e=t.od.od2;this.length=25;for(var i=this.length-1;i>=0;i--){var n=e[i];this.date.push(n.od21),o(n.od28)&&this.invalid.air.push(i),this.air.push(n.od28),o(n.od22)&&this.invalid.tem.push(i),this.tem.push(n.od22),o(n.od27)&&this.invalid.humidity.push(i),this.humidity.push(n.od27),o(n.od26)&&this.invalid.rain.push(i),this.rain.push(n.od26),o(n.od25,!0)&&this.invalid.wind.push(i),this.windLevel.push(n.od25),this.windAngle.push(n.od23),this.windDirection.push(n.od24),this.rainSum+=parseFloat(n.od26)||0}var s=function(t,a){var e=[];return $.each(t,function(i,n){isNaN(n)?(e.push(a),t[i]=""):e.push(n)}),e},l=d.max,c=d.min,h=function(t){for(var a=99,e=0;e<t.length;e++)t[e]&&Number(t[e])<a&&(a=t[e]);return a},p=function(t){return Math.floor(t)},m=function(t){return Math.ceil(t)},u=d.flagData;u.air.min=h(s(d.air,c.air)),u.air.max=a(s(d.air,l.air)),u.tem.min=h(s(d.tem,c.tem)),u.tem.max=a(s(d.tem,l.tem)),u.rain.min=h(s(d.rain,c.rain)),u.rain.max=a(s(d.rain,l.rain)),u.humidity.min=h(s(d.humidity,c.humidity)),u.humidity.max=a(s(d.humidity,l.humidity)),u.wind.min=h(s(d.windLevel,c.wind)),u.wind.max=a(s(d.windLevel,l.wind)),d.min.air=p(d.flagData.air.min),d.min.tem=p(d.flagData.tem.min),d.min.rain=p(d.flagData.rain.min),d.min.humidity=p(d.flagData.humidity.min),d.max.air=p(d.flagData.air.max),d.max.tem=p(d.flagData.tem.max),d.max.rain=m(d.flagData.rain.max),d.max.humidity=m(d.flagData.humidity.max),d.min.air=d.min.air-d.step.air,d.min.humidity-d.step.humidity>=0&&(d.min.humidity-=d.step.humidity),d.min.rain-d.step.rain>=0&&(d.min.rain-=d.step.rain),d.min.tem-d.step.tem>=0&&(d.min.tem-=d.step.tem),(d.max.air-d.min.air)/r>d.step.air&&(d.step.air=m((d.max.air-d.min.air)/r)),(d.max.humidity-d.min.humidity)/r>d.step.humidity&&(d.step.humidity=m((d.max.humidity-d.min.humidity)/r)),(d.max.rain-d.min.rain)/r>d.step.rain&&(d.step.rain=m((d.max.rain-d.min.rain)/r)),(d.max.tem-d.min.tem)/r>d.step.tem&&(d.step.tem=m((d.max.tem-d.min.tem)/r)),d.max.air=d.min.air+d.step.air*r,d.max.humidity=d.min.humidity+d.step.humidity*r,d.max.tem=d.min.tem+d.step.tem*r,d.max.humidity>100&&(d.max.humidity=100,d.min.humidity=d.max.humidity-d.step.humidity*r),d.max.rain=d.min.rain+d.step.rain*r}};d.init(t);var c=(s.find(".split").append('<p class="air on">过去24小时AQI最高值: '+d.flagData.air.max+'</p><p class="tem">最高气温: '+d.flagData.tem.max+"℃ , 最低气温: "+d.flagData.tem.min+'℃</p><p class="humidity">过去24小时最大相对湿度: '+d.flagData.humidity.max+'%</p><p class="wind">过去24小时最大风力: '+d.flagData.wind.max+'级</p><p class="rain">过去24小时总降水量：'+a(d.rain)+"mm</p>"),{width:0,height:0,leftgutter:0,bottomgutter:0,topgutter:0,rightgutter:0,rowNum:0,colNum:0,cellHeight:0,cellWidth:0,grid:null,rects:null,shap:null,path:null,pathStyle:{stroke:"#94c05a","stroke-width":2,"stroke-linejoin":"round"},init:function(t){var a=[];this.width=t.width,this.height=t.height,this.leftgutter=t.leftgutter,this.bottomgutter=t.bottomgutter,this.topgutter=t.topgutter,this.rightgutter=t.rightgutter,this.rowNum=t.rowNum,this.colNum=t.colNum,this.cellHeight=(this.height-this.topgutter-this.bottomgutter)/this.rowNum,this.cellWidth=(this.width-this.leftgutter-this.rightgutter)/this.colNum,l=Raphael(t.container,c.width,c.height),this.grid=l.drawGrid(c.leftgutter,c.topgutter,c.width-c.leftgutter-c.rightgutter,c.height-c.topgutter-c.bottomgutter,c.rowNum,"#eee"),this.rects=l.set(),this.shap=l.set();for(var e=0,i=this.colNum;i>e;e++)c.rects.push(l.rect(c.leftgutter+c.cellWidth*e,c.topgutter,c.cellWidth,c.height-c.bottomgutter-c.topgutter).attr({stroke:"none",fill:"#fff",opacity:0})),a.push("<span>"+t.date[e]+"</span>");$(".xLabel").html(a.join(""))},drawGraph:function(t){for(var a=[],e=t.step,i=t.unit,n=t.max,s=t.min,r=this.cellWidth,o=this.cellHeight,d=this.topgutter,h=this.leftgutter,p=this.height-d-this.bottomgutter,m=0;m<=this.rowNum;m++)a.unshift("<span>"+(s+m*e)+"</span>");if($(t.container).html(a.join("")),t.data.length!=t.invalid.length){var h=this.leftgutter,r=this.cellWidth,u=t.r||0,f=this.height-this.bottomgutter,w=$(t.dataContainer);switch(t.shap){case"rect":for(var v=[],m=0,g=this.colNum;g>m;m++){var x,y=Math.round(h+r*(m+.5))+.5,k=Math.round(o*((n-t.data[m])/e)+d),b="#fff";""==i?x=t.data[m]<=50?"#9dca80":t.data[m]<=100?"#f7da64":t.data[m]<=150?"#f29e39":t.data[m]<=200?"#da555d":t.data[m]<=300?"#b9377a":"#881326":t.data[m]<10?x="#6600CC":t.data[m]>=10&&t.data[m]<=25?x="#0000FF":t.data[m]>25&&t.data[m]<=50?x="#008000":t.data[m]>50&&t.data[m]<=100?x="#FFCC00":t.data[m]>100&&t.data[m]<=250?x="#FF6600":t.data[m]>250&&(x="#FF0000"),b&&x&&v.push({stroke:b,"stroke-width":1,fill:x}),this.shap.push(l.rect(y-.5*r+4,f,13,0).attr(v[m])),this.shap[m].animate({height:p-k+d,transform:["t0,"+(-f+k)]},500),function(t,a,e,n){if(""!=n&&0!=n){var s=function(){c.shap[t].attr({fill:"#076ea8"}),""==i?w.html(n+i):w.html(n+i);var s=w.width(),r=a+10;s+a>660&&(r=a-s-20),w.css({top:e,left:r-2}).show()},r=function(){c.shap[t].attr(v[t]),w.hide()};c.rects[t].hover(s,r),c.shap[t].hover(s,r)}}(m,y,k,t.data[m])}break;default:var C=[],_=l.path().attr({stroke:"#076ea8","stroke-width":1}),z=t.invalid.length+1,M=new Array(z),D=new Array(z),j=0;this.path=new Array(z);for(var m=0,g=this.colNum;g>m;m++){var y=Math.round(h+r*(m+.5))+.5,k=Math.round(o*((n-t.data[m])/e)+d),H=Math.round(o*((n-s)/e)+d);if(""==t.data[m])j++;else if(0!=m&&""!=t.data[m-1]||(D[j]=["M",y,k,"L",y,k],M[j]=["M",y,H,"L",y,H]),0!=m&&""!=t.data[m+1]&&""!=t.data[m-1]){var W=Math.round(o*(n-t.data[m-1])/e+d),I=Math.round(h+r*(m-.5)),S=Math.round(o*(n-t.data[m+1])/e+d),T=Math.round(h+r*(m+1.5));D[j]=D[j].concat(I,W,y,k,T,S),M[j]=M[j].concat(I,H,y,H,T,H)}if("dot"==t.shap){var q;"μg/m³"==i||""==i?q=t.data[m]<=50?"#6ac6ce":t.data[m]<=100?"#78ba60":t.data[m]<=150?"#f4b212":t.data[m]<=200?"#e24e31":t.data[m]<=300?"#ce1c5b":"#880b20":"℃"==i?t.data[m]<0?q="#6600CC":t.data[m]>=0&&t.data[m]<=5?q="#0000FF":t.data[m]>5&&t.data[m]<=10?q="#00CCFF":t.data[m]>10&&t.data[m]<=15?q="#008000":t.data[m]>15&&t.data[m]<=24?q="#FFCC00":t.data[m]>24&&t.data[m]<=32?q="#FF6600":t.data[m]>32&&(q="#FF0000"):t.data[m]<26?q="#FF0000":t.data[m]>=26&&t.data[m]<=51?q="#FF6600":t.data[m]>51&&t.data[m]<=75?q="#008000":t.data[m]>75&&(q="#6600CC"),q&&C.push({fill:q,stroke:q,"stroke-width":1}),this.shap.push(l.circle(y,f,u).attr(C[m]))}else 0==m&&C.push({fill:"red",stroke:"#6600CC","stroke-width":1}),this.shap.push(l.polygon(y,f,u).attr(C[0]));""==t.data[m]&&this.shap[m].hide(),"dot"==t.shap?this.shap[m].animate({cy:k},500).attr({cy:k}):this.shap[m].animate({transform:["t0,"+(-f+k)+"r"+(t.angle[m]-180)]},500),function(a,e,n,s,r){var l=function(){_.attr({path:["M",e,0,"V",c.height-25,"M",10,n+.5,"H",c.width]}).show(),w.html(r+s+i);var t=w.width(),a=e+10;t+e>660&&(a=e-t-20),w.css({top:n,left:a}).show()},o=function(){_.hide(),$(t.dataContainer).hide()};""!=s&&c.rects[a].hover(l,o),c.shap[a].hover(l,o)}(m,y,k,t.data[m],t.desc&&t.desc[m]||"")}for(var N=0;z>N;N++)M[N]&&(this.path[N]=l.path(M[N]),this.path[N].attr(this.pathStyle).hide(),this.path[N].animate({path:D[N]},470).show());for(var F=0,Z=this.colNum;Z>F;F++)this.shap[F]&&this.shap[F].toFront()}}}}),h={width:630,height:270,leftgutter:42,bottomgutter:40,topgutter:10,rightgutter:10,rowNum:r,colNum:d.length,container:"hourHolder",date:d.date},p={shap:"rect",container:".yLabel",dataContainer:".showData",min:d.min.air,max:d.max.air,data:d.air,unit:"",invalid:d.invalid.air,step:d.step.air,r:4};c.init(h),c.drawGraph(p);var m=d.length,u=($("#currHour"),$("#detailHour"),$("#hourHolder .result"));e(d.air);$("#weatherChart .tabs ul li").hover(function(){var t=$(this).attr("class");t.length>3||$(this).attr("class",$(this).attr("data-role")+" "+t)},function(){$(this).removeClass($(this).attr("data-role"))}).click(function(){var t=$(".aqiColorExp");if(!$(this).hasClass("on")){var a=$(this).siblings(".on"),n=$(this).attr("data-role");a.attr("data-role");a.attr("class",a.attr("class").replace("_on","")).removeClass("on"),$(this).attr("class",$(this).attr("class")+"_on").addClass("on"),u.hide(),s.find(".split").children().filter("."+n).addClass("on").siblings().removeClass("on");var r,o=d.invalid;switch(n){case"humidity":$("#sd").show().siblings("b").hide(),t.hide(),r=$.extend({},p,{shap:"dot",min:d.min.humidity,max:d.max.humidity,data:d.humidity,unit:"%",invalid:o.humidity,step:d.step.humidity});break;case"tem":$("#tem").show().siblings("b").hide(),t.hide(),r=$.extend({},p,{shap:"dot",min:d.min.tem,max:d.max.tem,data:d.tem,unit:"℃",invalid:o.tem,step:d.step.tem});break;case"air":$("#wd").show().siblings("b").hide();e(d.air);t.show();break;case"rain":$("#js").show().siblings("b").hide();var m=(e(d.rain),d.rainSum);(isNaN(m)||0==m||i(o.rain))&&u.html("24小时内无降水数据").show(),t.hide(),r=$.extend({},p,{min:d.min.rain,max:d.max.rain,data:d.rain,unit:"mm",step:d.step.rain,invalid:o.rain});break;case"wind":$("#fl").show().siblings("b").hide(),t.hide(),r=$.extend({},p,{shap:"polygon",min:d.min.wind,max:d.max.wind,data:d.windLevel,angle:d.windAngle,direction:d.windDirection,desc:d.windDirection,unit:"级",invalid:o.wind,step:d.step.wind,r:8})}l.remove(),c.init(h),c.drawGraph(r||p),$("#weatherChart .chart .detail").removeClass("detail"),$("#weatherChart .chart").find("."+n).addClass("detail")}});var f=!1;$.each(t.od.od2,function(t,a){a.od28&&(f=!0)}),f||$("#weatherChart [data-role=air]").hide().next().click()}function setHomepage(){var t=window.location.href;if(document.all)document.body.style.behavior="url(#default#homepage)",document.body.setHomePage(t);else if(window.sidebar){if(window.netscape)try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(a){alert("设为首页操作被浏览器拒绝，如果想启用设为首页功能，请选择信任此代码")}var e=Components.classes["@mozilla.org/preferences-service;1"].getService(Components.interfaces.nsIPrefBranch);e.setCharPref("browser.startup.homepage",t)}}function searchJudge(t){"输入城市名、景点名 查天气"!=t?readData(t,0):hide()}function readData(t,a){keyvalueOld=t,$.ajax({type:"GET",url:"http://toy1.weather.com.cn/search?cityname="+t,dataType:"jsonp",requestCount:++requestCount,jsonp:"callback",jsonpCallback:"success_jsonpCallback",timeout:3e3,async:!1,success:function(e){requestCount===this.requestCount&&(0==a&&(""==e?($("#show ul").html("<span style='color:#f00;'>对不起，未找到您查询的城市天气!</a></span>"),$("#show").show()):displayData(t,e)),1==a&&(""==e?window.location="http://www.weather.com.cn/forecast/index.shtml#input":(displayData(t,e),areaid=$("#show li.select").attr("num"),regEn.test(areaid)&&(window.location="http://www.weather.com.cn/html/province/"+areaid+".shtml#input"),regNum.test(areaid)&&(window.location="http://www.weather.com.cn/weather1d/"+areaid+".shtml#input"))))},error:function(){1==a&&(window.location="http://www.weather.com.cn/weather1d/"+areaid+".shtml#input")}})}function displayData(t,a){var e=[];$.each(a,function(t,a){e[t]=a.ref.split("~")});var i=e.sort(by("0")),n="",s="";regNum.test(t)&&$.each(i,function(a,e){var i=e[2]+"-"+e[9],n=RegExp(t,"ig");return n.test(e[6])&&(i+="-"+e[6]),n.test(e[7])&&(i+="-"+e[7]),i=i.replace(n,"<b>"+t+"</b>"),0==a&&(s+='<li class="select" num='+e[0]+">"+i+"</li>"),12>a&&a>0&&(s+='<li class="unselect" num='+e[0]+">"+i+"</li>"),11==a?!1:void 0}),regEn.test(t)&&$.each(i,function(a,e){var i=""!=e[9]?e[2]+"-"+e[9]:e[2],n=RegExp(t,"ig");return n.test(e[3])&&(i+="-"+e[3]),n.test(e[5])&&(i=e[2]+"-"+e[9]+"-"+e[5]),i=i.replace(n,"<b>"+t+"</b>"),n.test(e[8])&&(i+="-<b>"+e[8].toUpperCase()+"</b>"),0==a&&(s+='<li class="select" num='+e[0]+">"+i+"</li>"),12>a&&a>0&&(s+='<li class="unselect" num='+e[0]+">"+i+"</li>"),11==a?!1:void 0}),regCn.test(t)&&$.each(i,function(a,e){var i=""!=e[9]?e[2]+"-"+e[9]:e[2],n=RegExp(t,"ig"),n=RegExp(t,"ig"),i=i.replace(n,"<b>"+t+"</b>");return 0==a&&(s+='<li class="select" num='+e[0]+">"+i+"</li>"),12>a&&a>0&&(s+='<li class="unselect" num='+e[0]+">"+i+"</li>"),11==a?!1:void 0}),$("#show ul").html(s),$("#show").show(),$("#show li").mouseover(function(){$("#show li.select").removeClass("select").addClass("unselct"),$(this).removeClass("unselect").addClass("select")}).mouseout(function(){$(this).removeClass("select").addClass("unselect")}).click(function(){var t=$("#show li.select").text(),t=t.split("-");n=$("#show li.select").attr("num"),regEn.test(n)&&(window.location="http://www.weather.com.cn/html/province/"+n+".shtml#input"),regNum.test(n)&&(window.location="http://www.weather.com.cn/weather1d/"+n+".shtml#input"),1<t.length&&$("#txtZip").val(t[0]),hide()})}function hide(){$("#show").hide()}function keysearch(t){38==t.keyCode||40==t.keyCode||13==t.keyCode||27==t.keyCode||9==t.keyCode?(40==t.keyCode&&(""!=$("#show li.select").next().text()?$("#show li.select").removeClass("select").addClass("unselect").next().removeClass("unselect").addClass("select"):($("#show li.select").removeClass("select").addClass("unselect"),$("#show li:first").removeClass("unselect").addClass("select"))),38==t.keyCode&&(""!=$("#show li.select").prev().text()?$("#show li.select").removeClass("select").addClass("unselect").prev().removeClass("unselect").addClass("select"):($("#show li.select").removeClass("select").addClass("unselect"),$("#show li:last").removeClass("unselect").addClass("select"))),13==t.keyCode&&(t=$("#show li.select").text(),t=t.split("-"),areaid=$("#show li.select").attr("num"),regEn.test(areaid)&&(window.location="http://www.weather.com.cn/html/province/"+areaid+".shtml#input"),regNum.test(areaid)&&(window.location="http://www.weather.com.cn/weather1d/"+areaid+".shtml#input"),1<t.length&&$("#txtZip").val(t[0]),hide())):0==$("#txtZip").val().length&&hide()}function istrue(t){var a=/^((?=[0-9]+[A])|[0-9]+(?=[0-9]))[a-z0-9]+$/gi;return a.test(t)}define(function(require){require("jquery");var fxClass={"西南风":"SW","东南风":"SE","西北风":"NW","东北风":"NE","东风":"E","西风":"W","南风":"S","北风":"N"},cityId=location.href.match(/\d{9}/)[0],skUrl="http://d1.weather.com.cn/sk_2d/"+cityId+".html",alarmDataUrl="http://d1.weather.com.cn/dingzhi/_id_.html";$.ajax({type:"GET",url:skUrl,dataType:"script",success:function(){var t=$("#today .sk");if(dataSK&&"暂无实况"!=dataSK.temp){var a="";if(a+=dataSK.time&&'<p class="time"><span>'+dataSK.time+" 实况</span></p>"||"",a+=dataSK.sd&&'<div class="zs h"><i></i><span>相对湿度</span><em>'+dataSK.sd+"</em></div>"||"",a+=dataSK.WD&&'<div class="zs w"><i></i><span>'+dataSK.WD+"</span><em>"+dataSK.WS+"</em></div>"||"",dataSK.temp){var e=Number(dataSK.temp);a+='<div class="tem"><span>'+e+"</span><em>℃</em></div></p>";var i=.8*(e+50);a+='<div class="therm"><p><i class="t"></i><i class="c" style="height:'+i+'px"></i></p></div>'}var n=dataSK.aqi;if(n){var s=50>=n&&"#44cf12"||100>=n&&"#eec50b"||150>=n&&"#f6b42c"||200>=n&&"#fa5535"||300>=n&&"#e31b40"||n>300&&"#8e0636"||"#fff",r=50>=n&&"优"||100>=n&&"良"||150>=n&&"轻度污染"||200>=n&&"中度污染"||300>=n&&"重度污染"||n>300&&"严重污染"||"";a+='<div class="zs pol"><i></i><span><a style="color:'+s+'" href="http://www.weather.com.cn/air/?city='+dataSK.city+'" target="_blank">'+n+r+"</a></span></div>"}t.append(a)}else $(".sk").css("background",'url("http://i.tq121.com.cn/i/weather2014/city/zw.jpg") no-repeat scroll center center').empty()}}),$.getScript(alarmDataUrl.replace("_id_",cityId),function(){function _circle(){aA.eq(index).fadeIn().siblings().hide(),index++,index==len&&(index=0)}var arr=eval("alarmDZ"+cityId).w,len=arr.length;if(len){var gradeObj={"01":"blue","02":"yellow","03":"orange","04":"red",91:"white"},$item=$('<div class="sk_alarm"></div>');$.each(arr,function(t,a){var e="http://www.weather.com.cn/alarm/newalarmcontent.shtml?file="+a.w11,i="";i="00"==a.w6?"蓝色"==a.w7&&"blue"||"黄色"==a.w7&&"yellow"||"橙色"==a.w7&&"orange"||"红色"==a.w7&&"red"||"":gradeObj[a.w6],$item.append('<a class="'+i+'" href="'+e+'" target="_blank" title="'+a.w1+a.w2+a.w3+"气象台发布"+a.w5+a.w7+'预警">'+a.w5+"预警</a>")});var aA=$item.children("a");$item.appendTo($("#today .sk"));var index=0;_circle(),setInterval(_circle,4e3)}}),require("j/tool/raphael");var H={_getArrMax:function(t){return Math.max.apply(Math,t)||null},_getArrMin:function(t){return Math.min.apply(Math,t)||null},len:0,arrTime:[],arrWeapic:[],arrWeaTxt:[],arrTem:[],arrWinf:[],arrWinl:[],_clearArr:function(){H.arrTime=[],H.arrWeapic=[],H.arrWeaTxt=[],H.arrTem=[],H.arrWinf=[],H.arrWinl=[],H.arrCircle=[]},_initWeaData:function(t){H._clearArr(),$.each(t,function(t,a){var e=a.split(",");H.arrTime.push(e[0].substr(3)),H.arrWeapic.push(e[1]),H.arrWeaTxt.push(e[2]),H.arrTem.push(parseInt(e[3])),H.arrWinf.push(e[4]),H.arrWinl.push(e[5])}),this.len=t.length;var a=H._getArrMin(H.arrTem),e=H._getArrMax(H.arrTem);if(a!=e)var i=(this.svgH-20)/(e-a);else var i=(this.svgH-20)/1;this.cel_w=this.svgW/this.len;var n=[];$.each(H.arrTem,function(t,a){var s=H.cel_w*t+H.cel_w/2,r=(e-H.arrTem[t])*i+9;H.arrCircle.push({x:s,y:r}),n.push([s,r])}),this.svgPath=n.join(",")},svgW:680,svgH:70,cel_w:0,svgPath:"",arrCircle:[]},$F=$("#curve"),$time=$F.find(".time"),$weapic=$F.find(".wpic"),$winf=$F.find(".winf"),$winl=$F.find(".winl"),$tem=$F.find(".tem"),whichDay="1d";H._initWeaData(hour3data[whichDay].slice(0,8));for(var paper=Raphael("biggt",H.svgW,H.svgH),line=paper.path("M10,20").attr({stroke:"#f68227","stroke-width":2}),objCircle=[],originX=H.arrCircle[0].x,originY=H.arrCircle[0].y,i=0;i<=H.len-1;i++){$time.append($('<em style="width:'+H.cel_w+"px;left:"+H.cel_w*i+'px">'+H.arrTime[i]+"</em>"));var txt1=H.arrWinf[i],txt2=H.arrWinl[i];if("微风"==txt2)var txt1="微风",txt2="<3级";$winf.append($('<em style="width:'+H.cel_w+"px;left:"+H.cel_w*i+'px">'+txt1+"</em>").animate({left:H.cel_w*i+"px"},"slow")),$winl.append($('<em style="width:'+H.cel_w+"px;left:"+H.cel_w*i+'px">'+txt2+"</em>").animate({left:H.cel_w*i+"px"},"slow"));var circleX=H.arrCircle[i].x,circleY=H.arrCircle[i].y;objCircle.push(paper.circle(originX,originY,4).attr({fill:"#f68227",stroke:"#f68227",cx:circleX,cy:circleY})),$tem.append($('<em style="width:'+H.cel_w+"px;left:"+H.cel_w*i+"px;top:"+(circleY+70)+'px">'+H.arrTem[i]+"℃</em>")),$weapic.append($('<div style="width:'+H.cel_w+"px;left:"+H.cel_w*i+'px;top:30px"><big title="'+H.arrWeaTxt[i]+'" class="png40 '+H.arrWeapic[i]+'"></big></div>'))}line.attr({path:"M"+H.svgPath}),setAirData(observe24h_data);var $live_li3=$(".livezs .li3"),$live_li3_i=$live_li3.find("i");switch($live_li3.find("span").text()){case"舒适":$live_li3_i.addClass("v2");break;case"较舒适":$live_li3_i.addClass("v2");break;case"较冷":$live_li3_i.addClass("v2");break;case"冷":$live_li3_i.addClass("v3");break;case"寒冷":$live_li3_i.addClass("v3")}}),define(function(require){function picRoll(t){function a(a){a==2*s-1?(e.stop(!0,!0).animate({left:-n*a+"px"},"fast",function(){e.css("left",-n*s+n+"px")}),a=s-1):0==a?(e.stop(!0,!0).animate({left:-n*a+"px"},"fast",function(){e.css("left",-n*s+"px")}),a=s):e.stop(!0,!0).animate({left:-n*a+"px"},"fast"),i.find("li").removeClass(t.eleSmallClass).eq(a-s).addClass(t.eleSmallClass),$(t.eleText).html(e.children("li").eq(a).find("img").attr("alt")),r=a}t=$.extend({},defaultConfig,t);var e=$(t.eleFather).find("ul:has(img):first"),i=$(t.eleFather).find("ul:not(:has(img)):last"),n=e.find("img").width()||300,s=e.find("img").length;e.width(n*s*2).css("left",-n*s+"px"),e.append(e.html());var r=s,l=null;l=setInterval(function(){a(++r)},t.time),$(t.eleFather).mouseover(function(){clearInterval(l)}).mouseout(function(){l=setInterval(function(){a(++r)},t.time)});var o=$(t.rollLeft).css("opacity");$(t.rollLeft+","+t.rollRight).hover(function(){$(this).css("opacity",1)},function(){$(this).css("opacity",o)}),$(t.rollLeft).click(function(){a(--r)}),$(t.rollRight).click(function(){a(++r)}),i.empty();for(var d="",c=s-1;c>=0;c--)d+="<li></li>";i.append(d).find("li").live("click",function(){r=$(this).index(),a(r)}).first().addClass(t.eleSmallClass);var h=16*s;i.css("marginLeft",150-h/2+"px").width(h),$(t.eleText).html(e.find("img").first().attr("alt"))}require("jquery");var dataUrl="http://d1.weather.com.cn/spots/_proId_.html";$("#txt1,#txt2,#txt3").click(function(){$(this).parent().next().show()}).mouseleave(function(){$(this).parent().next().hide()}),$("#List1 a").live("click",function(){var t=$(this).parents(".Menu").hide(),a=$(this).text();$("p.txt1").text(a),$("span.jqu").text("景区"),$("span.jqu").attr("data-id",""),t.prev().children().val(a).attr("data-id",$(this).attr("data-id"))}),$("#List2 a").live("click",function(){var t=$(this).parents(".Menu").hide(),a=$(this).text();$("p.txt2").text(a),$("span.jqu").text("景区"),t.prev().children().val(a).attr("data-id",$(this).attr("data-id"))}),$("#List3 a").live("click",function(){var t=$(this).parents(".Menu").hide(),a=$(this).text();$("span.jqu").text(a),t.prev().children().children().text(a).attr("data-id",$(this).attr("data-id"))}),$("#txt3").live("click",function(){var $menu=$("#List2 a").parents(".Menu"),view=$menu.prev().children(),view_id=view.attr("data-id");if(!view_id)return alert("请选择景区级别"),!1;var proId=$("#txt1").attr("data-id"),str="";$.ajax({type:"GET",url:dataUrl.replace("_proId_",proId),dataType:"script",success:function(){var arr=eval("spot"+proId);$.each(arr[view_id],function(t,a){str+='<li><a target="_blank" data-id="'+t+'">'+a+"</a></li>"}),$("#List3 ul").empty().append(str)}})}),$(".Menu").mouseenter(function(){$(this).show()}).mouseleave(function(){$(this).hide()}),$("#viewSearch").click(function(){var t=$("#txt3").children().attr("data-id");t?window.open("http://www.weather.com.cn/weather1d/"+t+".shtml"):alert("请选择景区")}),$(".ctop .time").html($("#update_time").attr("value")+"更新"),$("#adposter_6287 p img").click(function(){$("#adposter_6287").hide()}),$("#duilian p img").click(function(){$("#duilian").hide()});var $ard=$("#around");$ard.find(".aro_view").children().length||($ard.find("h1").find("em").remove(),$ard.find("h1").find("span:eq(1)").remove()),$ard.find("h1").children("span").click(function(){"周边地区"==$(this).text()?($ard.find(".aro_view").hide(),$ard.find(".aro_city").show()):($ard.find(".aro_view").show(),$ard.find(".aro_city").hide())});var $hdImg_I=$(".hdImgs i").show();$.each($hdImg_I,function(t,a){if(2==t)$(a).height($(a).prev("b").height()+18);else{var e=$(a).prev("b").height();$(a).height(e+6).prev("b")}}),$(".greatEvent li").mousemove(function(){$(this).addClass("on").siblings("li").removeClass("on")}),$(".chartPH>h1>i").mouseenter(function(){var t=$(this),a=3-t.index();t.addClass("on").siblings().removeClass("on"),$(".chartPH>ul").hide().eq(a).show()});var defaultConfig={eleFather:null,eleText:null,eleSmallClass:"on",rollLeft:null,rollRight:null,time:3e3},picOpation1={eleFather:"#scrollPic",eleText:"#scrollPic p",eleSmallClass:"on",rollLeft:"#scrollPic .rollLeft",rollRight:"#scrollPic .rollRight"};picRoll(picOpation1);var picOpation2={eleFather:".travel",eleText:".travel p",eleSmallClass:"on",rollLeft:".travel .rollLeft",rollRight:".travel .rollRight"};picRoll(picOpation2)}),define(function(require){function initObjCookie(){$dzFo3d.hide(),$dzWork.hide(),$dzFo24h.hide(),$dzAlarm.hide(),$.each(objCookie.m.split(","),function(t,a){$dzPop.find("[data-name="+a+"]").addClass("selecton")}),$.each(objCookie.index.split(","),function(t,a){$indexUl.find("."+a).addClass("on")}),$_cookie(COOKIE_NAME,objCookie.cname+"|"+objCookie.cid+"|"+objCookie.m+"|"+objCookie.index,{expires:999,path:"/",domain:"weather.com.cn"}),updateWea()}function search(t){$.ajax({url:"http://toy1.weather.com.cn/search?cityname="+t,type:"GET",dataType:"jsonp",success:function(t){var a="<ul>";$.each(t,function(t,e){var i=e.ref.split("~");/^101/.test(i[0])&&!/A/.test(i[0])&&(a+='<li data-cid="'+i[0]+'" data-cname="'+i[2]+'">'+i[2]+"-"+i[9]+"-"+i[5]+"</li>")}),a+="</ul>",$dzsearchResult.html(a)}})}function updateWea(){function setFo3d(){$dzFo3d.show(),$.ajax({url:"http://d1.weather.com.cn/fc_3d_dz/"+objCookie.cid+".htm",type:"GET",dataType:"jsonp",jsonpCallback:"fc3day",success:function(t){for(var a="",e=0;3>e;e++){var i=t[e];a+="<li><h2>"+i.date+'</h2><div class="icon"><big class="blue22 '+i.icon.split("/")[0]+'"></big><big class="blue22 '+i.icon.split("/")[1]+'"></big></div><div class="wea">'+i.weather+'</div><div class="tem"><span>'+i.temp.split("/")[0]+"℃ /</span><em>"+i.temp.split("/")[1]+"℃</em></div></li>"}$dzFo3d.html(a)}})}function setFo24h(){$dzFo24h.show(),$.ajax({url:"http://d1.weather.com.cn/fc_3h_dz/"+objCookie.cid+".html",type:"GET",dataType:"jsonp",jsonpCallback:"dynamic3h",success:function(t){for(var a=[],e='<ul class="wea clearfix">',i='<ul class="time clearfix">',n=0;8>n;n++){var s=t[n];a.push(s.k6),e+='<li><big class="blue22 '+s.k3+'"></big></li>',i+="<li>"+s.k+"时</li>"}e+="</ul>",i+="</ul>",$dzFo24h.html(e+'<div id="dz-wealine" class="wealine"></div>'+i),drawLine("dz-wealine",a)}})}function setSxb(){$.ajax({url:"http://d1.weather.com.cn/sxb/"+objCookie.cid+".htm",type:"GET",dataType:"script",success:function(){$dzWork.show();for(var t="",a=2;a>0;a--){var e=1==a?"back":"go",i=1==a?"下班":"上班";if(goBackWork[e+"_img1"]==goBackWork[e+"_img2"])var n='<big class="blue22 '+goBackWork[e+"_img1"]+'"></big>';else var n='<big class="blue22 '+goBackWork[e+"_img1"]+'"></big><big class="blue22 '+goBackWork[e+"_img2"]+'"></big>';if(goBackWork[e+"_tem1"]==goBackWork[e+"_tem2"])var s="<span>"+goBackWork[e+"_tem1"]+"℃</span>";else var s="<span>"+goBackWork[e+"_tem1"]+"℃ /</span><em>"+goBackWork[e+"_tem2"]+"℃</em>";if(goBackWork[e+"_win1"]==goBackWork[e+"_win2"])var r=goBackWork[e+"_win1"];else var r=goBackWork[e+"_win1"]+"转"+goBackWork[e+"_win2"];if("微风"==r)var r="小于3级";t+='<li class="clearfix"><h1>'+i+'</h1><div class="img">'+n+'</div><p class="tem">'+s+"</p><b>风力："+r+"</b></li>"}$dzWork.html(t)}})}function setAlarm(){$.getScript("http://d1.weather.com.cn/dingzhi/"+objCookie.cid+".html",function(){function _circle(){$dzAlarm.find("a").eq(index).fadeIn().siblings().hide(),index++,index==len&&(index=0)}var alarms=eval("alarmDZ"+objCookie.cid).w;if(alarms.length){var temp="";$.each(alarms,function(t,a){temp+='<a target="_blank" href="http://www.weather.com.cn/alarm/newalarmcontent.shtml?file='+a.w11+'"><i></i><span>'+a.w1+a.w2+a.w3+"发布"+a.w5+a.w7+"预警</span></a>"}),$dzAlarm.html(temp).show();var index=0,len=alarms.length;_circle();var alarmInterval=setInterval(_circle,4e3);$dzAlarm.hover(function(){clearInterval(alarmInterval)},function(){alarmInterval=setInterval(_circle,4e3)})}})}$dzH1.html('<a id="dz-cname" href="http://www.weather.com.cn/weather1d/'+objCookie.cid+'.shtml" class="dcity"><span>'+objCookie.cname+'</span></a><i class="local"></i><em id="dz-set" class="set"><i></i></em>'),$.ajax({url:"http://d1.weather.com.cn/sk_2d/"+objCookie.cid+".html",type:"GET",dataType:"script",success:function(){var t=dataSK.aqi,a=50>=t&&"优"||100>=t&&"良"||150>=t&&"轻度污染"||200>=t&&"中度污染"||300>=t&&"重度污染"||t>300&&"严重污染"||"",e='<em id="dz-time" class="time">'+dataSK.time+'实况</em><div id="dz-tem" class="tem"><span>'+dataSK.temp+"</span><em>℃</em></div>"+(t&&'<div id="dz-aqi" class="aqi"><p>'+t+"</p><p>"+a+"</p></div>"||"")+'<div id="dz-detail" class="detail '+("0"!=dataSK.rain&&"暂无实况"!=dataSK.rain&&"p3"||"")+'"><p class="wind"><i class="'+dataSK.wde+'"></i><span>'+dataSK.WD+"  "+dataSK.WS+'</span></p><p class="hum"><i></i><span>湿度  '+dataSK.SD+"</span></p>"+("0"!=dataSK.rain&&"暂无实况"!=dataSK.rain&&'<p class="rain"><i></i><span>整点降水  '+dataSK.rain+"mm</span></p>"||"")+"</div>";$dzSk.html(e)}}),$.ajax({url:"http://d1.weather.com.cn/zs_index/"+objCookie.cid+".html",type:"GET",dataType:"script",success:function(){for(var t=dataZS.zs,a="",e=objCookie.index.split(","),i=0;3>i;i++)a+='<li class="'+e[i]+'"><h1>'+t[e[i]+"_name"]+"</h1><p><i></i><span>"+t[e[i]+"_hint"]+"</span></p></li>";$dzTag.html(a)}}),$.each(objCookie.m.split(","),function(t,a){switch(a){case"work":setSxb();break;case"fo3d":setFo3d();break;case"fo24h":setFo24h();break;case"alarm":setAlarm()}})}function drawLine(t,a){function e(t,a,e,i,n,s){var r=(e-t)/2,l=(n-e)/2,o=Math.atan((e-t)/Math.abs(i-a)),d=Math.atan((n-e)/Math.abs(i-s));o=i>a?Math.PI-o:o,d=i>s?Math.PI-d:d;var c=Math.PI/2-(o+d)%(2*Math.PI)/2,h=r*Math.sin(c+o),p=r*Math.cos(c+o),m=l*Math.sin(c+d),u=l*Math.cos(c+d);return{x1:e-h,y1:i+p,x2:e+m,y2:i+u}}$("#"+t).empty();var i=300,n=100,s=0,r=20,l=18,o=(Math.random(),"#88d0f7"),d=Raphael(t,i,n),c=(d.set(),{dots:[[],[],[],[]],rects:[],lineNum:0,Max:0,Min:0,_getMaxMin:function(){this.Max=Math.max.apply(Math,a),this.Min=Math.min.apply(Math,a)},_setLine:function(t,a,o){var h,p=t.length,m=[];this._getMaxMin();for(var u=(i-s)/p,f=this.Max-this.Min,w=n-r-l,v=w/f,$=d.path().attr({stroke:a,"stroke-width":2,"stroke-linejoin":"round",opacity:"0.8","stroke-dasharray":o}),g=d.path().attr({stroke:"none",opacity:.3,fill:a}),x=0,y=p;y>x;x++){if(t[x])var k=Math.round(n-r-v*(t[x]-c.Min)),b=Math.round(s+u*(x+.5));else var k=-100,b=-100;var C=d.circle(b,k,2).attr({fill:"#148fd0",stroke:"#148fd0","stroke-width":1,title:t[x]});d.text(b,k-10,t[x]+"℃").attr({fill:"#666"});if(c.dots[c.lineNum].push(C),!m.length&&t[x]&&(m=["M",b,k,"C",b,k],h=["M",s+.5*u,n,"L",b,k,"C",b,k]),t[x]&&x&&y-1>x){var _=Math.round(n-r-v*t[x-1]),z=Math.round(s+u*(x-.5)),M=Math.round(n-r-v*t[x+1]),D=Math.round(s+u*(x+1.5)),j=e(z,_,b,k,D,M);m=m.concat([j.x1,j.y1,b,k,j.x2,j.y2]),h=h.concat([j.x1,j.y1,b,k,j.x2,j.y2])}}m=m.concat([b,k,b,k]),h=h.concat([b,k,b,k,"L",b,n,"z"]),$.attr({path:m}),g.attr({path:h})},_init:function(){this._setLine(a,o)}});c._init()}require("jquery"),require("j/tool/tool_raphael"),require("j/tool/cookie");var COOKIE_NAME="dzwea",cookieData=$_cookie(COOKIE_NAME)||"北京|101010100|alarm,work|uv,gm,ct",cd=cookieData.split("|"),objCookie={cname:cd[0],cid:cd[1],m:cd[2],index:cd[3]},$dz=$("#dz"),$dzCname=$dz.find("#dz-cname"),$dzCnameSpan=$dzCname.children("span"),$dzSk=$dz.find("#dz-sk"),$dzH1=$dz.find("h1"),$dzAlarm=$dz.find("#dz-alarm"),$dzSet=$dz.find("#dz-set"),$dzWork=$dz.find("#dz-work"),$dzTag=$dz.find("#dz-tag"),$dzFo24h=$dz.find("#dz-fo24h"),$dzFo3d=$dz.find("#dz-fo3d"),$dzLocal=$dz.find(".local"),$dzPop=$("#dzpop"),$dzsearch=$("#dzsearch"),$dzsearchResult=$dzsearch.find("#dzsearch-result"),$dzsearchCon=$dzsearch.find(".con"),$dzsearchClose=$dzsearch.find(".close"),$dzsearchInput=$dzsearch.find(".txt"),$dzsearchBtn=$dzsearch.find(".btn");
$dzSet.live("click",function(){$dzPop.stop(!0,!0).animate({right:0},600)}),$dzLocal.live("click",function(){$dzsearch.fadeIn(),$dzsearchCon.animate({top:"30%"},500)}),$dzsearchResult.find("li").live("click",function(){$this=$(this),objCookie.cname=$this.data("cname"),objCookie.cid=$this.data("cid"),$dzsearchClose.click(),$dzsearchResult.hide(),initObjCookie()}),$dzsearchBtn.click(function(){$dzsearchResult.find("li:first").click()}),$dzsearchClose.click(function(){$dzsearch.fadeOut(),$dzsearchCon.animate({top:"-180px"},500)}),$dzsearchInput.keyup(function(t){$dzsearchResult.show(),search($(this).val())}),$dzsearch.find(".cbg").click(function(){$dzsearchResult.hide()});var $select=$dzPop.find(".dzalert").click(function(t){var a=$(this).find("[data-id=select]");a.hasClass("selecton")?a.removeClass("selecton"):a.addClass("selecton")}),$c3to1=$dzPop.find(".c3to1").click(function(){$c3to1.find("[data-id=select]").removeClass("selecton"),$(this).find("[data-id=select]").addClass("selecton")}),objIndexs={3:"您已经选满3个指数",2:"请再选择1个指数",1:"请再选择2个指数",0:"请选择您感兴趣的3个指数"},$dzPopText=$dzPop.find("#dzpop-text"),$indexUl=$dzPop.find("#dzpop-index");$indexUl.find("li").click(function(){var t=$indexUl.find(".on").length;3>t?$(this).hasClass("on")?($(this).removeClass("on"),$dzPopText.text(objIndexs[t-1])):($(this).addClass("on"),$dzPopText.text(objIndexs[t+1])):$(this).hasClass("on")&&($(this).removeClass("on"),$dzPopText.text(objIndexs[t-1]))});var data=["-2","2","0","-3","-5","-7","-8","-7"];drawLine("wealine",data),$("#dzpop-save").click(function(){var t=$indexUl.find(".on");if(3!=t.length)alert(objIndexs[t.length]);else{var a=[];$.each($dzPop.find(".selecton"),function(t,e){a.push($(e).data("name"))});var e=[];$.each(t,function(t,a){e.push($(a).data("ind"))}),objCookie.m=a.join(","),objCookie.index=e.slice(0,3).join(","),$dzPop.stop(!0,!0).animate({right:"-400px"},600)}initObjCookie()}),$dzPop.find("#dzpop-close").click(function(){$dzPop.stop(!0,!0).animate({right:"-400px"},600)}),initObjCookie()});var by=function(t){return function(a,e){var i,n;if("object"==typeof a&&"object"==typeof e&&a&&e)return i=a[t],n=e[t],i===n?0:typeof i==typeof n?n>i?-1:1:typeof n>typeof i?-1:1;throw"error"}},requestCount=0,keyvalueOld="",regNum=/^[0-9]*[0-9][0-9]A*$/,regEn=/^[A-Za-z]+$/,regCn=RegExp("[一-龥]"),requestOccur=0;define(function(require){function initDzCity(){DZ._initCookieDatas()}function cookieMaker(t,a,e){if("undefined"==typeof a){var i=null;if(document.cookie&&""!=document.cookie)for(var n=document.cookie.split(";"),s=0;s<n.length;s++){var r=jQuery.trim(n[s]);if(r.substring(0,t.length+1)==t+"="){i=decodeURIComponent(r.substring(t.length+1));break}}return i}e=e||{},null===a&&(a="",e.expires=-1);var l="";if(e.expires&&("number"==typeof e.expires||e.expires.toUTCString)){var o;"number"==typeof e.expires?(o=new Date,o.setTime(o.getTime()+24*e.expires*60*60*1e3)):o=e.expires,l="; expires="+o.toUTCString()}var d=e.path?"; path="+e.path:"",c=e.domain?"; domain="+e.domain:"",h=e.secure?"; secure":"";document.cookie=[t,"=",encodeURIComponent(a),l,d,c,h].join("")}require("jquery"),$(".city-tt a").click(function(t){t.stopPropagation(),$(this).addClass("cur").siblings().removeClass("cur"),$(".w_city").eq($(".city-tt a").index($(this))).show().siblings(".w_city").hide()}),$(".text").click(function(){$(".city-box").addClass("show_head")}),$(".city-tt b").click(function(){$(".city-box").hide()}),$(".sheng").click(function(){$(".sheng-show").slideToggle(500)}),$(".sjz").click(function(){$(".provinceLinks").animate({height:"toggle"},"normal")}),$(".nav a[id="+$("#colorid").val()+"]").addClass("sheng"),$(".menu a[id="+$("#colorid").val()+"]").parent().addClass("sheng"),$(".menu a[id="+$("#colorid").val()+"]").addClass("color"),$(".nav a[id="+$("#colortid").val()+"]").addClass("sheng");var navid=$(".nav a").attr("id"),dizhi=window.location.href,dizhi=dizhi.split("/"),dizhi=dizhi.pop().split("."),str=dizhi[0];if(istrue(str)){var aaa=str.length;if(7==aaa){var rs="http://wgeo.weather.com.cn/ip/";$.getScript(rs,function(){$.getScript("http://d1.weather.com.cn/index_around/"+id+".html",function(){var t=around.n;$.each(t,function(t,a){$(".city_guonei").eq(1).find("dd").eq(0).append("<a href='http://www.weather.com.cn/weather1d/"+a.ac+".shtml' title='"+a.an+"'>"+a.an+"</a>")});var a=around.jd;$.each(a,function(t,a){$(".city_guonei").eq(1).find("dd").eq(1).append("<a href='http://www.weather.com.cn/weather1d/"+a.ac+".shtml' title='"+a.an+"'>"+a.an+"</a>")})})})}else $.getScript("http://d1.weather.com.cn/index_around/"+dizhi[0]+".html",function(){var t=around.n;$.each(t,function(t,a){$(".city_guonei").eq(1).find("dd").eq(0).append("<a href='http://www.weather.com.cn/weather1d/"+a.ac+".shtml#around1' title='"+a.an+"'>"+a.an+"</a>")});var a=around.jd;$.each(a,function(t,a){$(".city_guonei").eq(1).find("dd").eq(1).append("<a href='http://www.weather.com.cn/weather1d/"+a.ac+".shtml#around1' title='"+a.an+"'>"+a.an+"</a>")})})}else{var rs="http://wgeo.weather.com.cn/ip/";$.getScript(rs,function(){$.getScript("http://d1.weather.com.cn/index_around/"+id+".html",function(){var t=around.n;$.each(t,function(t,a){$(".city_guonei").eq(1).find("dd").eq(0).append("<a href='http://www.weather.com.cn/weather1d/"+a.ac+".shtml#around1' title='"+a.an+"'>"+a.an+"</a>")});var a=around.jd;$.each(a,function(t,a){$(".city_guonei").eq(1).find("dd").eq(1).append("<a href='http://www.weather.com.cn/weather1d/"+a.ac+".shtml#around1' title='"+a.an+"'>"+a.an+"</a>")})})})}$("#txtZip").focus(function(){""!=$("#txtZip").val()&&"输入城市名、景点名 查天气"!=$("#txtZip").val()||($("#idss").show(),hide()),$(this).val()==this.defaultValue?$(this).val(""):""!=$("#txtZip").val()&&"输入城市名、景点名 查天气"!=$("#txtZip").val()&&$("#show").show(),setInterval(function(){var t=$("#txtZip").val();""==t&&hide(),t!=keyvalueOld&&($("#idss").hide(),searchJudge(t))},300),$(".city-box").show()}),$(document).click(function(){""==$("#txtZip").val()?($("#show").hide(),$("#txtZip").val("输入城市名、景点名 查天气")):$("#show").hide()}),$("#txtZip").add("#selectsionTabs").click(function(t){return t.stopPropagation(),!1}),$("#selectsionTabs span").click(function(){var t=$("#selectsionTabs span").index(this);$("#selectsionGroups ul").hide(),$("#selectsionGroups ul").eq(t).show(),$("#selectsionTabs span").removeClass("active"),$(this).addClass("active")}),$("#selectsionTabs .tab").click(function(){return event.stopPropagation(),!1}),$("#btnZip").bind("click",function(t){return t.stopPropagation(),t=$("#txtZip").val(),""==t||"输入城市名、景点名 查天气"==$.trim(t)?(window.location="http://www.weather.com.cn/forecast/index.shtml#input",!1):void readData(t,1)}),$("#txtZip").keyup(function(t){var a=$("#txtZip");a.offset(),a.height(),""==$("#txtZip").val()&&(keyvalueOld=""),keysearch(t)}),$(document).click(function(){$(".city-box").hasClass("show_head")&&$(".city-box").hide()});var DZ={COOKIE_NAME:"f_city",default_id:101010100,default_name:"北京,北京,北京",weaJsonUrl:"http://d1.weather.com.cn/dingzhi/_id_.html",cookieDatas:[],_initCookieDatas:function(){$(".w_weather").empty();var t=cookieMaker(DZ.COOKIE_NAME);if(DZ.cookieDatas=[],t){for(var a=t.split(","),e=0,i=a.length;i>e;e++){var n=a[e].split("|");DZ.cookieDatas.unshift({cityName:n[0],cityId:n[1],cityCusName:n[2]})}DZ._goWeaDatas()}else $.ajax({type:"get",dataType:"script",url:"http://wgeo.weather.com.cn/ip/",success:function(){var t={cityName:addr.split(",").pop(),cityId:id,cityCusName:""};DZ.cookieDatas.push(t),DZ._goWeaDatas();var a=t.cityName+"|"+t.cityId+"|"+t.cityCusName;cookieMaker(DZ.COOKIE_NAME,a,{expires:999,path:"/",domain:"weather.com.cn"})}});$(".w_weather .delete").live("click",function(){var t=$(this).parents("li").attr("data-n");DZ._remove(t),DZ._goWeaDatas()})},_remove:function(t){for(var a=[],e=DZ.cookieDatas.length-1;e>=0;e--){var i=DZ.cookieDatas[e];i.cityId==t?DZ.cookieDatas.splice(e,1):a.push(i.cityName+"|"+i.cityId+"|"+i.cityCusName)}cookieMaker(DZ.COOKIE_NAME,a.join(","),{expires:999,path:"/",domain:"weather.com.cn"})},_goWeaDatas:function(){function gets(){var d=DZ.cookieDatas[point];$.ajax({type:"get",dataType:"script",url:DZ.weaJsonUrl.replace("_id_",d.cityId),success:function(){var city=eval("cityDZ"+d.cityId).weatherinfo,weaDatas={id:city.city,name:city.cityname,tem1:city.temp,tem2:city.tempn,txt:city.weather,icon1:city.weathercode,icon2:city.weathercoden,wind:city.wd,windl:city.ws,alarms:eval("alarmDZ"+d.cityId).w},moreClass=DZ.cookieDatas.length>1&&"dz_right"||"";point==DZ.cookieDatas.length-1?DZ._setDomHeadCity(weaDatas,moreClass):DZ._setDomMoreCity(weaDatas),point--?gets():$(".w_weather ul").append('<li class="add"> <a href="http://www.weather.com.cn/profile/city.shtml"  target="_self">+</a> </li>')}})}var point=DZ.cookieDatas.length-1;gets()},_setDomHeadCity:function(t,a){var e='<a href="http://www.weather.com.cn/weather1d/'+t.id+'.shtml#dingzhi_first" target="_self" title="'+t.txt+'"><span class="city_name"><em>'+t.name+'</em></span> <big class="icon '+t.icon1+' fl"></big> <big class="icon '+t.icon2+' fl"></big> <em class="fl s">'+t.tem1+"/"+t.tem2+"</em> </a>";t.alarms.length&&(e+='<a class="fl w_yj" href="http://www.weather.com.cn/alarm/newalarmlist.shtml?areaId='+t.id+'"></a>'),e+='<a class="add fl '+a+'" href="http://www.weather.com.cn/profile/city.shtml" target="_self">+</a>',e+='<ul class="more" style="display: none;"></ul>',$(".w_weather").empty().html(e)},_setDomMoreCity:function(t){function a(t){t.live("mouseover mouseout",function(t){"mouseover"==t.type?(o.show(),d.addClass("dz_down")):(o.hide(),d.removeClass("dz_down"))})}var e="";t.alarms.length&&(e='<em class="w_yj"></em>'),$(".w_weather ul").append('<li data-n="'+t.id+'"><a title="'+t.txt+'" target="_self" href="http://www.weather.com.cn/weather1d/'+t.id+'.shtml#dingzhi_more" class="clearfix"><span>'+t.name+'</span><big class="'+t.icon1+' ic"></big><big class="'+t.icon2+' ic"></big><em>'+t.tem1+"/"+t.tem2+'</em></a><b class="delete"></b></li>');var i=$(".w_weather"),n=i.find(".city_name"),s=n.children("em"),r=n.width(),l=s.width();l>r&&s.hover(function(){$(this).stop(!0).animate({left:"-"+(l-r)+"px"},"slow")},function(){$(this).css("left","0px")});var o=i.find(".more");a(o);var d=i.find("a.dz_right");a(d)}};DZ._initCookieDatas();var Event=require("../m_event"),dzEvent=(W.data||(W.data={}))["event.dz_city"]=new Event;dzEvent.on("modify",DZ._initCookieDatas)});